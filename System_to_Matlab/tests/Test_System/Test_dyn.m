function [xdot] = Test_dyn(x, u, params) 
	x0 = 2*q1dot;
	x1 = sin(q2);
	x2 = cos(q2);
	x3 = x1.*x2;
	x4 = q2dot.*x3;
	x5 = x0.*x4;
	x6 = q1dot.*q3dot;
	x7 = cos(x);
	x8 = x7.^4;
	x9 = l2.*x1;
	x10 = sin(q3);
	x11 = m3.*x10.^3;
	x12 = s3.*x11.*x9;
	x13 = x12.*x8;
	x14 = m2.*s2.^2;
	x15 = q3dot.*x0;
	x16 = x7.^2;
	x17 = sin(x);
	x18 = x17.^2;
	x19 = x16.*x18;
	x20 = x15.*x19;
	x21 = q1dot.*q2dot;
	x22 = x21.*x8;
	x23 = cos(q3);
	x24 = s3.*x23;
	x25 = l2.*x2;
	x26 = x24.*x25;
	x27 = m3.*x26;
	x28 = m3.*x23.^3;
	x29 = s3.*x28;
	x30 = x16.*x25;
	x31 = x18.*x30;
	x32 = q2dot.*x0.*x31;
	x33 = s3.^2;
	x34 = x33.*x8;
	x35 = x34.*x6;
	x36 = x10.*x23;
	x37 = m3.*x36;
	x38 = x18.*x23;
	x39 = x33.*x38;
	x40 = x15.*x16.*x39;
	x41 = x11.*x23;
	x42 = x17.^4;
	x43 = x33.*x42;
	x44 = x43.*x6;
	x45 = x23.^2;
	x46 = l2.^2.*m3;
	x47 = x45.*x46;
	x48 = q1dot.*x4;
	x49 = x47.*x48;
	x50 = x46.*x48;
	x51 = s3.*x45;
	x52 = x10.*x9;
	x53 = m3.*x52;
	x54 = x51.*x53;
	x55 = x42.*x6;
	x56 = x19.*x5;
	x57 = x15.*x36;
	x58 = x25.*x29;
	x59 = x21.*x42;
	x60 = x10.^2;
	x61 = x26.*x60;
	x62 = m3.*x61;
	x63 = x10.*x28;
	x64 = x6.*x8;
	x65 = s3.*x53;
	x66 = x46.*x60;
	x67 = x48.*x66;
	x68 = x12.*x42;
	x69 = m3.*x24;
	x70 = x60.*x69;
	x71 = -AS2.*x5 + AS3.*x57 + BS2.*x5 - BS3.*x57 - iG1.*u - m3.*x10.*x40 - x11.*x40 - x12.*x20 - x13.*x6 + x14.*x5 - x20.*x33.*x63 - x20.*x54 - x20.*x65 + x22.*x27 + x22.*x58 + x22.*x62 + x27.*x59 + x29.*x32 + x32.*x69 + x32.*x70 - x35.*x37 - x35.*x41 - x35.*x63 - x37.*x44 - x41.*x44 + x42.*x49 + x42.*x50 + x42.*x67 - x44.*x63 + x46.*x56 + x47.*x56 + x49.*x8 + x50.*x8 - x54.*x55 - x54.*x64 - x55.*x65 + x56.*x66 + x58.*x59 + x59.*x62 - x6.*x68 - x64.*x65 + x67.*x8;
	x72 = -x17.*x24 - x17.*x9;
	x73 = x7.*x72;
	x74 = x24.*x7 + x7.*x9;
	x75 = x17.*x74;
	x76 = -x10.*x73 - x10.*x75;
	x77 = x23.*x73 + x23.*x75;
	x78 = x1.^2;
	x79 = 1./(AS2.*x2.^2 + AS3.*x60 + BM1.*iG1.^2 + BS1 + BS2.*x78 + BS3.*x45 + m3.*x76.^2 + m3.*x77.^2 + m3.*(-x17.*x72 + x7.*x74).^2 + x14.*x78);
	x80 = x10.*x25;
	x81 = -x16.*x80 - x18.*x80 - x23.*x9;
	x82 = m3.*x81;
	x83 = x23.*x30 + x25.*x38 - x52;
	x84 = m3.*x77;
	x85 = x76.*x82 + x83.*x84;
	x86 = 1./(CM2.*iG2.^2 + CS2 + m3.*x81.^2 + m3.*x83.^2 + x14 - x79.*x85.^2);
	x87 = x79.*x85;
	x88 = x10.*x24;
	x89 = -x16.*x88 - x18.*x88 + x88;
	x90 = s3.*x60;
	x91 = x16.*x90 + x18.*x90 + x51;
	x92 = m3.*x76.*x91 + x84.*x89;
	x93 = m3.*x83.*x89 + x82.*x91 - x87.*x92;
	x94 = x86.*x93.^2;
	x95 = 1./(CM3.*iG3.^2 + CS3 + m3.*x89.^2 + m3.*x91.^2 - x79.*x92.^2 - x94);
	x96 = x86.*x93;
	x97 = -x79.*x92 + x87.*x96;
	x98 = x95.*x97;
	x99 = x86.*(-x87 - x93.*x98);
	x100 = x92.*x95;
	x101 = q1dot.^2;
	x102 = x101.*x3;
	x103 = x102.*x42;
	x104 = q2dot.^2;
	x105 = x104.*x3;
	x106 = x105.*x66;
	x107 = 2*x16;
	x108 = x107.*x18;
	x109 = x102.*x108;
	x110 = x101.*x42;
	x111 = m3.*params;
	x112 = q3dot.^2;
	x113 = x111.*x60;
	x114 = x112.*x58;
	x115 = 2*x31;
	x116 = x115.*x29;
	x117 = x101.*x8;
	x118 = x105.*x47;
	x119 = x102.*x8;
	x120 = x112.*x62;
	x121 = x115.*x70;
	x122 = AS2.*x102 - BS2.*x102 - M2.*iG2 - m2.*params.*s2.*x1 - x101.*x116 - x101.*x121 - x102.*x14 - x103.*x47 - x103.*x66 - x106.*x108 - x106.*x42 - x106.*x8 + x106 - x108.*x118 - x109.*x47 - x109.*x66 - x110.*x58 - x110.*x62 - x111.*x45.*x9 - x112.*x116 + x112.*x12 - x112.*x121 + x112.*x54 - x113.*x9 - x114.*x42 - x114.*x8 - x117.*x58 - x117.*x62 - x118.*x42 - x118.*x8 + x118 - x119.*x47 - x119.*x66 - x120.*x42 - x120.*x8;
	x123 = x86.*(x94.*x95 + 1);
	x124 = x101.*x23;
	x125 = x10.*x124;
	x126 = x112.*x33;
	x127 = x126.*x63;
	x128 = x101.*x63;
	x129 = x107.*x11;
	x130 = m3.*x104;
	x131 = x130.*x51.*x52;
	x132 = x11.*x124;
	x133 = x126.*x41;
	x134 = x108.*x12;
	x135 = -AS3.*x125 + BS3.*x125 - M3.*iG3 + params.*x29 + x101.*x108.*x54 + x101.*x129.*x39 + x101.*x134 + x101.*x68 + x104.*x13 + x104.*x134 - x104.*x58 + x104.*x68 + x108.*x127 + x108.*x128.*x33 + x108.*x131 + x110.*x54 + x113.*x24 + x117.*x12 + x117.*x54 + x126.*x129.*x38 + x127.*x42 + x127.*x8 - x127 + x128.*x34 + x128.*x43 - x130.*x61 + x131.*x42 + x131.*x8 + x132.*x34 + x132.*x43 + x133.*x42 + x133.*x8 - x133;
	x136 = x95.*x96;
	x137 = -x122.*x79.*(x100.*x96 - x123.*x85) - x135.*x79.*(-x100 + x136.*x85) - x71.*x79.*(-x100.*x97 - x85.*x99 + 1);
	x138 = x135.*x95;
	x139 = -x122.*x123 + x138.*x96 - x71.*x99;
	x140 = x122.*x136 - x138 - x71.*x98;

	q1 = x;
	M1 = u;
	g = params;
	M1 = u;
	[q1dot; q2dot; q3dot; q1ddot; q2ddot; q3ddot] = [q1dot; q2dot; q3dot; x137; x139; x140];
	xdot = [q1dot; q2dot; q3dot; x137; x139; x140];
end